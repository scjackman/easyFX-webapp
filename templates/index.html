<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EasyFX</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
    .currency-btn {
        font-size: 6rem;
        background: none;
        border: none;
        line-height: 1;
        padding: 0;
    }
    .arrow-btn {
        font-size: 2rem;
        background: none;
        border: none;
        cursor: pointer;
    }
</style>
</head>
<body class="bg-light">
    <div class="container d-flex flex-column align-items-center justify-content-center min-vh-100">
        <div class="card p-4 shadow rounded" style="width: 100%; max-width: 400px;">
            <h4 class="text-center mb-4">EasyFX</h4>

            <!-- Currency selector -->
            <div class="d-flex justify-content-center align-items-center mb-5"> <!-- changed from mb-3 to mb-5 -->
                <span id="from-flag" class="currency-btn">ðŸ‡¨ðŸ‡¦</span>
                <button id="swap-btn" class="arrow-btn mx-3">-></button>
                <span id="to-flag" class="currency-btn">ðŸ‡¬ðŸ‡§</span>
            </div>

            <!-- Amount input -->
            <div class="mb-3">
                <input type="number" class="form-control form-control-lg" id="amount-input" placeholder="Enter amount" min="0" step="any">
            </div>

            <!-- Convert button -->
            <div class="d-grid mb-3">
                <button id="convert-btn" class="btn btn-primary btn-lg">Convert</button>
            </div>

            <!-- Result -->
            <div id="result" class="text-center fs-5 fw-semibold text-success"></div>
        </div>
    </div>

    <script>
        // Initial state
        let fromCurrency = "CAD";
        let toCurrency = "GBP";

        const swapBtn = document.getElementById("swap-btn");
        const convertBtn = document.getElementById("convert-btn");
        const amountInput = document.getElementById("amount-input");
        const resultEl = document.getElementById("result");

        // Handle currency swap
        swapBtn.addEventListener("click", () => {
            [fromCurrency, toCurrency] = [toCurrency, fromCurrency];
            swapBtn.textContent = fromCurrency == "CAD" ? "->" : "<-";
            resultEl.textContent = "";  // clear result on swap
        });

        // Handle conversion
        convertBtn.addEventListener("click", async () => {
            const amount = parseFloat(amountInput.value);
            if (isNaN(amount) || amount <= 0) {
                resultEl.textContent = "Please enter a valid amount.";
                resultEl.classList.remove("text-success");
                resultEl.classList.add("text-danger");
                return;
            }

            // Send POST request to Flask
            try {
                const response = await fetch("/convert", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        amount: amount,
                        from: fromCurrency,
                        to: toCurrency
                    })
                });

                if (!response.ok) {
                    throw new Error("Conversion failed.");
                }

                const data = await response.json();
                const convertedAmount = data.converted_amount;

                resultEl.textContent = `${amount} ${fromCurrency} = ${convertedAmount.toFixed(2)} ${toCurrency}`;
                resultEl.classList.remove("text-danger");
                resultEl.classList.add("text-success");
            } catch (error) {
                resultEl.textContent = "Error converting currency.";
                resultEl.classList.remove("text-success");
                resultEl.classList.add("text-danger");
            }
        });
    </script>

</body>
</html>
